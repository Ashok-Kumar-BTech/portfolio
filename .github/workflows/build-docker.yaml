name: Build and Publish image to Docker Hub
on: #Trigger the workflow on speicfic actions
  push:
    branches:
      - main
    paths:
      - Dockerfile
      - .github/workflows/**
      - src/**

jobs:
  publish_images:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Build image
        run: docker build . -t ashokkumarbtech/portfolio:1.0
      - name: Push image to the docker hub
        env:
          DOCKER_HUB_TOKEN: ${{ secrets.DOCKER_HUB_TOKEN }}
        run: | # the pipe denotes that the command is a multi-line command
          docker echo "$DOCKER_HUB_TOKEN" | docker login -u ashokkumarbtech --password-stdin
          docker push ashokkumarbtech/portfolio:1.0
